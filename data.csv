inquiry_id,question,sql
inquiry_MTzoIbMP,In what countries are most of our jobs offered?,"SELECT t.country_name AS Country, COUNT(*) AS Job_Count FROM `draftboard-368620.JEDIFY.job_locations` AS t WHERE t.country_name IS NOT NULL AND t.country_name <> '' AND t.created_at >= '2024-01-01' AND t.created_at < '2024-01-20' GROUP BY t.country_name ORDER BY Job_Count DESC"
inquiry_aiTiTTpt,What is the churn rate of a scout after trying to fill their first position?,"WITH UserData AS (\n  SELECT\n    ur.user_id,\n    MAX(s.last_session_date) AS last_session_date,\n    COUNT(DISTINCT a.id) AS applications,\n    COUNT(DISTINCT ur.id) AS roles_num\n  FROM\n    `draftboard-368620.JEDIFY.user_roles` ur\n  JOIN `JEDIFY.job_applications` a ON ur.user_id = a.scout_id\n  LEFT JOIN `draftboard-368620.JEDIFY.jobs` j ON a.job_id = j.id\n  LEFT JOIN `draftboard-368620.JEDIFY.company_industries` ci ON j.company_id = ci.company_id\n  JOIN (\n    SELECT DISTINCT\n      JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id') AS scout_id,\n      MAX(DATE(created_at)) AS last_session_date\nFROM `draftboard-368620.JEDIFY.analytic_events` ae\n    WHERE created_at >= '2024-11-22' AND created_at < '2024-11-29'\n    GROUP BY JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id')\n  ) s ON s.scout_id = ur.user_id\n  WHERE ur.role = 10\n  GROUP BY ur.user_id\n  HAVING roles_num = 1\n),\nChurn AS (\n  SELECT\n    COUNT(*) AS churn_count\n  FROM\n    UserData\n  WHERE\n    applications = 1\n    AND DATE_ADD(last_session_date, INTERVAL 30 DAY) < CURRENT_DATE()\n)\nSELECT\n  SAFE_DIVIDE((SELECT churn_count FROM Churn), COUNT(DISTINCT user_id)) * 100 AS churn_rate_after_first_app\nFROM UserData;\n"
inquiry_nzDQlAKx,What is the average time to fulfill a job?,"WITH hiredJobIds AS( SELECT job_id, date FROM( SELECT JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') AS job_id, JSON_EXTRACT_SCALAR(DATA, '$.dms.date') AS date, FROM `draftboard-368620.JEDIFY.analytic_events` AS ae WHERE event_name = 'Hired' AND TIMESTAMP(created_at) >= '2024-11-22' AND TIMESTAMP(created_at) < '2024-11-29' UNION ALL SELECT JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') AS job_id, JSON_EXTRACT_SCALAR(DATA, '$.dms.date') AS date, FROM `draftboard-368620.JEDIFY.records` AS r WHERE event_name = 'Hired' UNION ALL SELECT JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') AS job_id, JSON_EXTRACT_SCALAR(DATA, '$.dms.date') AS date, FROM `draftboard-368620.JEDIFY.analytic_events` AS ae WHERE event_name = 'Hired' UNION ALL SELECT JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') AS job_id, JSON_EXTRACT_SCALAR(DATA, '$.dms.date') AS date, FROM `draftboard-368620.JEDIFY.records` AS r WHERE event_name = 'Hired') WHERE job_id IS NOT NULL), Averages AS (SELECT AVG(DATE_DIFF((CASE WHEN hiredJobIds.date IS NOT NULL THEN CAST(PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%E*S%Ez', hiredJobIds.date) AS DATE) ELSE j.archived_at END ), j.created_at, DAY)) AS average_days_to_fulfill_a_job FROM `draftboard-368620.JEDIFY.jobs` AS j WHERE j.created_at >= '2024-11-22' AND j.created_at < '2024-11-29' JOIN hiredJobIds ON j.id = hiredJobIds.job_id) SELECT * from Averages WHERE average_days_to_fulfill_a_job IS NOT NULL"
inquiry_gJUTBJjF,How does the average time to fill a job vary by industry and location?,"WITH hiredJobs AS( SELECT *, FROM( SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') AS job_id, FROM `draftboard-368620.JEDIFY.analytic_events` WHERE event_name = 'Hired' AND created_at >= '2024-11-22' AND created_at < '2024-11-29' UNION ALL SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') AS job_id, FROM `draftboard-368620.JEDIFY.records` WHERE event_name = 'Hired' UNION ALL SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') AS job_id, FROM `draftboard-368620.JEDIFY.analytic_events` WHERE event_name = 'Hired' UNION ALL SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') AS job_id, FROM `draftboard-368620.JEDIFY.records` WHERE event_name = 'Hired' AND created_at >= '2024-11-22' AND created_at < '2024-11-29') as hiredJobIds join `draftboard-368620.JEDIFY.jobs` AS jobs on hiredJobIds.job_id=jobs.id WHERE job_id IS NOT NULL) SELECT t4.title AS Industry, t2.country AS Country, AVG(DATE_DIFF(hiredJobs.archived_at, hiredJobs.published_at, DAY)) AS Average_Days_To_Fill FROM `draftboard-368620.JEDIFY.companies` AS t1 JOIN `draftboard-368620.JEDIFY.company_industries` AS t4 ON t1.id = t4.company_id JOIN hiredJobs ON t1.id = hiredJobs.company_id JOIN `draftboard-368620.JEDIFY.job_locations` AS t2 ON hiredJobs.id = t2.job_id GROUP BY Industry, Country ORDER BY Industry, Country"
inquiry_wTCHJIzI,What is the trend in activation time for scouts?,"\nDECLARE start_date DATE DEFAULT '2024-11-22';\nDECLARE end_date DATE DEFAULT '2024-11-29';\nDECLARE days_diff INT64 DEFAULT DATE_DIFF(end_date, start_date, DAY);\nWITH UserData AS (\n    SELECT \n        u.created_at, \n        u.id,\n        DATE_DIFF(MIN(ja.created_at), MIN(u.created_at), DAY) AS days_to_activate\n    FROM \n        `JEDIFY.users` u\n    JOIN `JEDIFY.user_roles` ur ON u.id = ur.user_id\n    JOIN `JEDIFY.job_applications` ja ON u.id = ja.scout_id\n    GROUP BY \n        u.id, u.created_at\n    HAVING\n    COUNT(DISTINCT ur.role)=1 AND MAX(ur.role)=10\n),\nBucketedData AS (\n    SELECT\n        CASE \n            WHEN days_diff < 30 THEN FORMAT_DATE('%m/%d/%Y', DATE(u.created_at))\n            WHEN days_diff <= 90 THEN FORMAT_DATE('%m/%d/%Y', DATE_TRUNC(DATE(u.created_at), WEEK(MONDAY)))\n            ELSE FORMAT_DATE('%m/%d/%Y', DATE_TRUNC(DATE(u.created_at), MONTH))\n        END AS bucket,\n        u.id,\n        u.days_to_activate\n    FROM \n        UserData u\n    WHERE \n        u.created_at >= start_date AND u.created_at < end_date\n)\nSELECT\n    bucket AS bucket_size,\n    COUNT(DISTINCT id) AS created_scouts,\n    AVG(days_to_activate) AS avg_days_to_activate\nFROM \n    BucketedData\nGROUP BY \n    bucket_size\nORDER BY \n    bucket_size DESC;\n"
inquiry_ilGkUSVJ,Which industries have the most jobs posted?,"SELECT c.title, COUNT(*) AS job_count FROM `draftboard-368620.JEDIFY.jobs` j JOIN `draftboard-368620.JEDIFY.company_industries` c ON j.company_id = c.company_id WHERE j.status = 'active' AND j.created_at >= '2024-11-03' AND j.created_at < '2024-11-16' GROUP BY c.title ORDER BY job_count DESC"
inquiry_nGVomnFc,Is it easier to fill remote jobs than local jobs?,"WITH hiredJobIds AS( SELECT job_id, FROM ( SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') AS job_id, FROM `draftboard-368620.JEDIFY.analytic_events` WHERE event_name = 'Hired' AND created_at >= '2024-11-22' AND created_at < '2024-11-29' UNION ALL SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') AS job_id, FROM `draftboard-368620.JEDIFY.records` WHERE event_name = 'Hired' UNION ALL SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') AS job_id, FROM `draftboard-368620.JEDIFY.analytic_events` WHERE event_name = 'Hired' UNION ALL SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') AS job_id, FROM `draftboard-368620.JEDIFY.records` WHERE event_name = 'Hired') WHERE job_id IS NOT NULL ) SELECT *, (job_count-filled_jobs_count )AS active_jobs_count, safe_divide(filled_jobs_count,job_count)AS filled_precentage FROM ( SELECT IF(j.workplace = ""remote"", ""Remote"", ""Not remote"") AS remote, COUNT(DISTINCT j.id) AS job_count, COUNT(DISTINCT hiredJobIds.job_id)AS filled_jobs_count, FROM `draftboard-368620.JEDIFY.jobs` AS j WHERE j.created_at >= '2024-11-22' AND j.created_at < '2024-11-29' LEFT JOIN hiredJobIds ON j.id=hiredJobIds.job_id GROUP BY remote )"
inquiry_wfjvWIfK,What is the average time from a company onboarding to posting a first job?,"SELECT c.name AS name, AVG(TIMESTAMP_DIFF(j.first_job_created, c.created_at, DAY)) AS average_days FROM `draftboard-368620.JEDIFY.companies` AS c JOIN (SELECT company_id, MIN(created_at) AS first_job_created FROM `draftboard-368620.JEDIFY.jobs` WHERE created_at >= '2024-11-22' AND created_at < '2024-11-29' GROUP BY company_id) AS j ON c.id = j.company_id WHERE c.name <> """" AND LOWER(c.name) NOT LIKE ""%test%"" AND c.created_at >= '2024-11-22' AND c.created_at < '2024-11-29' GROUP BY c.id,c.name ORDER BY average_days DESC;"
inquiry_CgVJxdCo,What is the total number of active scouts?,"SELECT COUNT(DISTINCT user_id) AS total_active_scouts FROM(select count(distinct ur.id) roles_num, ur.user_id FROM `draftboard-368620.JEDIFY.user_roles` ur join (SELECT distinct JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id') AS scout_id, JSON_EXTRACT_SCALAR(DATA, '$.dms.session_id') AS session_id, DATE(created_at) AS session_date FROM `draftboard-368620.JEDIFY.analytic_events` where event_name in (""Approved"",""Declined"",""LinkShared"") and date_add(created_at ,interval 30 day) > cast(CURRENT_DATE() as timestamp) and created_at >= '2024-11-22' and created_at < '2024-11-29') s on ur.user_id = s.scout_id join `JEDIFY.job_applications` a on ur.user_id = a.scout_id where ur.role = 10 group by ur.user_id having roles_num = 1 )"
inquiry_SYpdieFW,How many daily active scouts do we have?,"SELECT distinct count(distinct JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id')) AS daily_active_scouts, FORMAT_TIMESTAMP('%m/%d/%Y', DATE(created_at)) AS session_date from draftboard-368620.JEDIFY.analytic_events where event_name in (""Approved"",""Declined"",""LinkShared"") AND created_at >= '2024-11-22' AND created_at < '2024-11-29' group by FORMAT_TIMESTAMP('%m/%d/%Y', DATE(created_at)) order by session_date desc"
inquiry_DxfBdoQx,List the LinkedIn profiles of all candidates who held at least 1 interview,"  with interviews as    (SELECT ae.created_at,     COALESCE(       JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id'),       JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId')     ) AS job_id,         COALESCE(       JSON_EXTRACT_SCALAR(DATA, '$.dms.application_id'),       JSON_EXTRACT_SCALAR(DATA, '$.dms.applicationId')     ) AS application_id   FROWHERE     event_name = 'Interaction'     AND (       JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') IS NOT NULL OR       JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') IS NOT NULL     ) AND created_at >= '2024-11-01' AND created_at < '2024-11-29'M     `draftboard-368620.JEDIFY.analytic_events` AS ae   WHERE     event_name = 'Interaction'     AND (       JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') IS NOT NULL OR       JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') IS NOT NULL     )   UNION ALL   SELECT r.created_at,     COALESCE(       JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id'),       JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId')     ) AS job_id,             COALESCE(       JSON_EXTRACT_SCALAWHERE     event_name = 'Interaction'     AND (       JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') IS NOT NULL OR       JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') IS NOT NULL     ) AND created_at >= '2024-11-01' AND created_at < '2024-11-29')R(DATA, '$.dms.application_id'),       JSON_EXTRACT_SCALAR(DATA, '$.dms.applicationId')     ) AS application_id   FROM     `draftboard-368620.JEDIFY.records` AS r   WHERE     event_name = 'Interaction'     AND (       JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') IS NOT NULL OR       JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') IS NOT NULL     ))  select c.name as company_name,j.title as job_title, ca.first_name, ca.last_name, ca.linkedin_url from interviews join `JEDIFY.job_applications` ja on interviews.application_id = ja.id  left join `JEDIFY.jobs` j on ja.job_id = j.id left join `JEDIFY.companies` c on j.company_id = c.id left join `JEDIFY.candidates` ca on ja.contact_id = ca.contact_id  where interviews.created_at is not null"
inquiry_TSbsbAJk,Are more remote jobs being offered over time?,"\nDECLARE start_date DATE DEFAULT DATE '2024-11-01';\nDECLARE end_date DATE DEFAULT DATE '2024-11-29';\nDECLARE days_diff INT64 DEFAULT DATE_DIFF(end_date, start_date, DAY);\nWITH date_range AS (\n  SELECT \n    j.created_at,\n    j.id,\n    jl.workplace,\n    CASE \n      WHEN days_diff < 30 THEN FORMAT_TIMESTAMP('%m/%d/%Y', DATE(j.created_at))\n      WHEN days_diff >= 30 AND days_diff < 90 THEN FORMAT_TIMESTAMP('%m/%d/%Y',DATE_TRUNC(DATE(j.created_at), WEEK(MONDAY)))\n      ELSE FORMAT_TIMESTAMP('%m/%d/%Y',DATE_TRUNC(DATE(j.created_at), MONTH))\n    END AS bucket\n  FROM \n    `draftboard-368620.JEDIFY.jobs` AS j\n  JOIN \n    `draftboard-368620.JEDIFY.job_locations` AS jl ON j.id = jl.job_id\n  WHERE \n    j.created_at >= start_date AND \n    j.created_at < end_date AND \n    j.status = 'active'\n)\nSELECT \n  bucket AS bucket_size,\n  COUNT(*) AS total_jobs,\n  SUM(CASE WHEN workplace =""remote"" THEN 1 ELSE 0 END) AS remote_jobs\nFROM \n  date_range\nGROUP BY \n  bucket_size\nORDER BY \n  bucket_size DESC;\n"
inquiry_mgkrkXmB,How many new jobs have been published?,"DECLARE start_date DATE DEFAULT '2024-11-22';\nDECLARE end_date DATE DEFAULT '2024-11-29';\nDECLARE days_diff INT64 DEFAULT DATE_DIFF(end_date, start_date, DAY);\n\nWITH date_range AS (\n    SELECT \n        j.published_at, \n        j.id, \n        CASE \n            WHEN days_diff < 30 THEN FORMAT_TIMESTAMP('%m/%d/%Y', DATE(j.published_at))\n            WHEN days_diff <= 90 THEN FORMAT_TIMESTAMP('%m/%d/%Y', DATE_TRUNC(DATE(j.published_at), WEEK(MONDAY)))\n            ELSE FORMAT_TIMESTAMP('%m/%d/%Y', DATE_TRUNC(DATE(j.published_at), MONTH))\n        END AS bucket\n    FROM \n        `draftboard-368620.JEDIFY.jobs` AS j LEFT OUTER JOIN `draftboard-368620.JEDIFY.company_industries` AS ci ON j.company_id = ci.company_id \n    WHERE \n        j.published_at >= start_date AND j.published_at < end_date\n)\nSELECT \n    bucket AS bucket_size, \n    COUNT(DISTINCT id) AS new_jobs\nFROM \n    date_range\nGROUP BY \n    bucket_size\nORDER BY \n    bucket_size;\n"
inquiry_SzLjkOni,What is the monthly trend in company signups?,"SELECT COUNT(DISTINCT `name`) AS `company_count`, FORMAT_TIMESTAMP('%m/%Y', CAST(created_at AS TIMESTAMP)) as `month-year` FROM `draftboard-368620.JEDIFY.companies` AS `t` WHERE created_at >= '2024-11-22' AND created_at < '2024-11-29' GROUP BY `month-year` ORDER BY `month-year` DESC"
inquiry_BbwpqBwE,How many scouts have utilized the watchlist feature?,"SELECT distinct COUNT(DISTINCT user_id) over () as total_unique_users ,FORMAT_TIMESTAMP('%m/%d/%Y',cast(created_at as date)) date, COUNT(DISTINCT user_id) over (partition by cast(created_at as date)) AS day_unique_users FROM `JEDIFY.watchlist` wl WHERE created_at >= '2024-11-21' AND created_at < '2024-11-28' order by date "
inquiry_mjBWCAXs,What is the average number of jobs for which a scout refers candidates?,"SELECT AVG(job_count) AS average_jobs_referred FROM( SELECT ja.scout_id, COUNT(DISTINCT ja.job_id) AS job_count FROM `draftboard-368620.JEDIFY.job_applications` AS ja WHERE ja.created_at >= '2024-11-21' AND ja.created_at < '2024-11-28' GROUP BY ja.scout_id) t"
inquiry_FjUmkreH,What is the average number of scouts submitting applicants for a job?,"SELECT AVG(number_of_scouts) AS average_scouts_per_job FROM (SELECT COUNT(DISTINCT scout_id) AS number_of_scouts, job_id FROM draftboard-368620.JEDIFY.job_applications GROUP BY job_id WHERE created_at >= '2024-11-21' AND created_at < '2024-11-28') AS derived_table"
inquiry_VgpchAtY,Do the signing bonuses affect the interest of scouts in filling the position?,"SELECT bonus_amount_bucket, count(distinct app_id)/count(distinct job_id) AS total_applications FROM( SELECT j.job_id, AVG(j.bonus_amount) AS avg_bonus_amount,a.id as app_id, CASE WHEN AVG(j.bonus_amount) < 1000 THEN 'Less than $1000' WHEN AVG(j.bonus_amount) >= 1000 AND AVG(j.bonus_amount) < 3000 THEN '$1000 to $3000' WHEN AVG(j.bonus_amount) >= 3000 AND AVG(j.bonus_amount) < 7000 THEN '$3000 to $7000' WHEN AVG(j.bonus_amount) >= 7000 AND AVG(j.bonus_amount) < 10000 THEN '$7000 to $10000' ELSE 'More than $10000' END AS bonus_amount_bucket FROM `draftboard-368620.JEDIFY.job_details` AS j JOIN `draftboard-368620.JEDIFY.job_applications` AS a ON j.job_id = a.job_id WHERE a.created_at >= '2024-11-21' AND a.created_at < '2024-11-28' GROUP BY j.job_id,a.id ORDER BY avg_bonus_amount DESC) GROUP BY bonus_amount_bucket ORDER BY total_applications desc"
inquiry_VdbyVloS,Retrieve the scout leaderboard with their key performance metrics.,"SELECT u.name, COUNT(DISTINCT ja.id) AS applications, SUM( CASE WHEN ja.status >= 15 THEN 1 ELSE 0 END) as referrals\n, SUM( CASE WHEN ja.status IN (100,50) THEN 1 ELSE 0 END) AS placements FROM `draftboard-368620.JEDIFY.users` AS u JOIN `draftboard-368620.JEDIFY.job_applications` AS ja ON u.id = ja.scout_id LEFT OUTER JOIN `draftboard-368620.JEDIFY.jobs` AS j ON ja.job_id = j.id WHERE u.name IS NOT NULL and u.name <> '' AND ja.created_at >= '2024-11-21' AND ja.created_at < '2024-11-28' GROUP BY u.name, u.rating ORDER BY referrals DESC"
inquiry_zybIkFfn,Can you bucket our scouts based on the number of applications they have handled?,"WITH applicationsCount AS( SELECT scout_id, COUNT(*) AS application_count FROM `draftboard-368620.JEDIFY.job_applications` \n    WHERE created_at >= '2024-11-21' AND created_at < '2024-11-28'\n    GROUP BY scout_id) SELECT 'Less than 3 applications' AS Bucket, COUNT(CASE WHEN application_count<3 THEN 1 ELSE NULL END ) AS application_count FROM applicationsCount UNION ALL SELECT 'Between 3 and 8 applications' AS Bucket, COUNT(CASE WHEN application_count>3 AND application_count<8 THEN 1 ELSE NULL END ) AS application_count FROM applicationsCount UNION ALL SELECT 'More than 8 applications' AS Bucket, COUNT(CASE WHEN application_count>8 THEN 1 ELSE NULL END ) AS application_count FROM applicationsCount"
inquiry_YNwWOpZH,What is the relationship between a job's salary range in USD and the average candidate experience level?,"SELECT CASE WHEN j.min_amount < 50000 THEN 'Less than $50K' WHEN j.min_amount >= 50000 AND j.min_amount < 100000 THEN '$50K to $99K' WHEN j.min_amount >= 100000 AND j.min_amount < 150000 THEN '$100K to $149K' WHEN j.min_amount >= 150000 AND j.min_amount < 200000 THEN '$150K to $199K' ELSE 'More than $200K' END AS Salary_Range, j.currency, j.period, AVG(c.min_years_of_experience) AS Average_Experience FROM `draftboard-368620.JEDIFY.job_salaries` AS j JOIN `draftboard-368620.JEDIFY.jobs` AS jobs ON j.job_id = jobs.id JOIN `draftboard-368620.JEDIFY.job_applications` AS ja ON jobs.id = ja.job_id JOIN `draftboard-368620.JEDIFY.candidates` AS c ON ja.contact_id = c.contact_id WHERE ja.created_at >= '2024-11-21' AND ja.created_at < '2024-11-28' GROUP BY Salary_Range, j.currency, j.period ORDER BY Average_Experience ASC"
inquiry_TLaZFFaF,Show me the company attributes that scouts tend to submit referrals for.,"SELECT c.name AS company_name, ci.title AS company_industry, ca.partner AS company_ats, COUNT(ja.id) AS referral_count, AVG(jd.bonus_amount) AS average_bonus, AVG(jd.min_rating) AS average_min_rating FROM `draftboard-368620.JEDIFY.job_applications` AS ja JOIN `draftboard-368620.JEDIFY.companies` AS c ON ja.company_id = c.id JOIN `draftboard-368620.JEDIFY.company_industries` AS ci ON ci.company_id = c.id JOIN `draftboard-368620.JEDIFY.company_ats` AS ca ON ca.company_id = c.id JOIN `draftboard-368620.JEDIFY.job_details` AS jd ON ja.job_id = jd.job_id  WHERE ja.created_at >= '2024-11-01' AND ja.created_at < '2024-11-28'\nGROUP BY c.name, ci.title, ca.partner  ORDER BY referral_count DESC LIMIT 10"
inquiry_bcKDsgEU,What is the monthly trend in scouts signups?,"SELECT COUNT(DISTINCT t.`id`) AS `scouts_count`, FORMAT_TIMESTAMP('%m/%Y', CAST(t.created_at AS TIMESTAMP)) AS `month-year` FROM `draftboard-368620.JEDIFY.users` AS `t` join draftboard-368620.JEDIFY.user_roles ur on t.id = ur.user_id where ur.role = 10 AND t.created_at >= '2024-11-21' AND t.created_at < '2024-11-28' GROUP BY `month-year` ORDER BY `month-year` DESC\n"
inquiry_ednrZarV,What is the month-over-month growth rate of new company signups?,"  WITH MonthlyData AS ( SELECT FORMAT_TIMESTAMP('%m/%Y', created_at) AS month, COUNT(DISTINCT name) AS new_companieFROM `draftboard-368620.JEDIFY.companies` \n    WHERE created_at >= '2024-11-21' AND created_at < '2024-11-28's FROM `draftboard-368620.JEDIFY.companies` GROUP BY month ORDER BY month ), GrowthRates AS ( SELECT current_.month, current_.new_companies, LAG(current_.new_companies) OVER (ORDER BY current_.month) AS previous_companies, IFNULL(((current_.new_companies - LAG(current_.new_companies) OVER (ORDER BY current_.month)) / LAG(current_.new_companies) OVER (ORDER BY current_.month)), 0) AS growth_rate FROM MonthlyData as current_ ) SELECT month, growth_rate FROM GrowthRates ORDER BY month"
inquiry_ZjweeWmi,Produce a summary of job referrals per scout,"SELECT u.name, COUNT(DISTINCT ja.id) AS jobs_referred, SUM( CASE WHEN ja.status IN (100,35,50) THEN 1 ELSE 0 END) AS successful_referrals, SUM(CASE WHEN ja.status IN (13,14,17) THEN 1 ELSE 0 END ) AS rejected_referrals, FROM `draftboard-368620.JEDIFY.users` AS u JOIN `draftboard-368620.JEDIFY.job_applications` AS ja ON u.id = ja.scout_id WHERE u.name IS NOT NULL and u.name <> '' AND ja.created_at >= '2024-11-21' AND ja.created_at < '2024-11-28' GROUP BY u.name, u.rating ORDER BY successful_referrals DESC, rejected_referrals DESC, jobs_referred DESC LIMIT 30"
inquiry_AYwEGFxN,What is the average number of candidates referred per scout?,"SELECT AVG(referred_candidates) AS average_referred_candidates FROM (SELECT `scout_id`, COUNT(distinct contact_id) AS referred_candidates FROM `draftboard-368620.JEDIFY.job_applications` where highest_status >= 15 AND created_at >= '2024-11-21' AND created_at < '2024-11-28' GROUP BY `scout_id`) AS referral_counts"
inquiry_HFkXsJwJ,List the 10 scouts with the highest placement rate.,"SELECT CONCAT(u.first_name, ' ', u.last_name) AS scout_name, COUNT(*) AS `total_placements`, COUNTIF(`highest_status` IN(50, 100)) AS `successful_placements`, SAFE_DIVIDE(COUNTIF(`highest_status` IN(50, 100)), COUNT(*)) AS `placement_rate` FROM `draftboard-368620.JEDIFY.job_applications` ja JOIN `draftboard-368620.JEDIFY.users` u ON ja.scout_id=u.id WHERE `highest_status` IN(100, 35, 50) AND ja.created_at >= '2024-11-01' AND ja.created_at < '2024-11-27' GROUP BY scout_name ORDER BY `placement_rate` DESC LIMIT 10"
inquiry_yGfoaDpM,Show the ratio of remote jobs vs. local jobs.,"SELECT distinct FORMAT_TIMESTAMP('%m/%y', CAST(published_at AS TIMESTAMP)) as `month-year`, sum(case when workplace = 'remote' then 1 else 0 end) over () as total_remote_jobs, COUNT(DISTINCT id) over () as total_jobs , (sum(case when workplace = 'remote' then 1 else 0 end) over () / COUNT(DISTINCT id) over () ) as total_remote_ratio_from_jobs, sum(case when workplace = 'remote' then 1 else 0 end) over (partition by FORMAT_TIMESTAMP('%m/%y', CAST(published_at AS TIMESTAMP))) as monthly_remote_jobs, count(distinct id) over (partition by FORMAT_TIMESTAMP('%m/%y', CAST(published_at AS TIMESTAMP))) as monthly_jobs, (sum(case when workplace = 'remote' then 1 else 0 end) over (partition by FORMAT_TIMESTAMP('%m/%y', CAST(published_at AS TIMESTAMP)))/ count(distinct id) over (partition by FORMAT_TIMESTAMP('%m/%y', CAST(published_at AS TIMESTAMP)))) as monthly_remote_ratio_from_jobs FROM draftboard-368620.JEDIFY.jobs where published_at is not null AND published_at >= '2024-11-01' AND published_at < '2024-11-27'  ORDER BY `month-year`"
inquiry_pPbFyhlB,What is the average number of candidates interviewed per closed job?,"WITH interviews AS (\n  SELECT\n    COALESCE(\n      JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id'),\n      JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId')\n    ) AS job_id\n  FROM\n    `draftboard-368620.JEDIFY.analytic_events` AS ae\nWHERE\n    event_name = 'Interaction'\n    AND (\n      JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') IS NOT NULL OR\n      JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') IS NOT NULL\n    )\n    AND created_at >= '2024-11-01'\n    AND created_at < '2024-11-27'\n    AND created_at >= '2024-11-01'\n    AND created_at < '2024-11-27'\n  UNION ALL\n  SELECT\n    COALESCE(\n      JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id'),\n      JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId')\n    ) AS job_id\n  FROM\n    `draftboard-368620.JEDIFY.records` AS r\n  WHERE\n    event_name = 'Interaction'\n    AND (\n      JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') IS NOT NULL OR\n      JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') IS NOT NULL\n    )\n),\njobs_with_companies AS (\n  SELECT\n    j.id AS job_id,\n    j.status,\n    ci.company_id\n  FROM\n    `draftboard-368620.JEDIFY.jobs` AS j\n  LEFT OUTER JOIN `draftboard-368620.JEDIFY.company_industries` AS ci\n    ON j.company_id = ci.company_id\n  WHERE\n    j.status = 'archive'\n)\nSELECT\n  AVG(num_interviews) AS avg_interviews_before_close\nFROM (\n  SELECT\n    jwc.job_id,\n    COUNT(*) AS num_interviews\n  FROM\n    interviews AS i\n  JOIN jobs_with_companies AS jwc\n    ON i.job_id = jwc.job_id\n  GROUP BY\n    jwc.job_id\n)\n"
inquiry_vFdTZxJz,Which ATS's are most commonly used by companies on the platform?,"SELECT partner, count(distinct company_id) as cnt FROM `draftboard-368620.JEDIFY.company_ats` WHERE created_at >= '2024-11-20' AND created_at < '2024-11-27' group by partner"
inquiry_lEbiFZcx,How many companies have signed up for the platform?,SELECT COUNT(DISTINCT j.`company_id`) AS number_of_companies FROM `draftboard-368620.JEDIFY.jobs` AS j WHERE j.created_at >= '2024-11-19' AND j.created_at < '2024-11-26'
inquiry_FXZaIIcf,Which countries offer the highest paying jobs?,"\nSELECT t1.country_name AS Country, ROUND(AVG(t2.min_amount),0) AS Average_Minimum_Salary, ROUND(AVG(t2.max_amount),0) AS Average_Maximum_Salary FROM `draftboard-368620.JEDIFY.jobs` AS t0 JOIN `draftboard-368620.JEDIFY.job_locations` AS t1 ON t0.id = t1.job_id JOIN `draftboard-368620.JEDIFY.job_salaries` AS t2 ON t1.job_id = t2.job_id JOIN `draftboard-368620.JEDIFY.company_industries` AS t3 ON t0.company_id = t3.company_id where t1.country_name is not null and t1.country_name <> '' AND t0.created_at >= '2024-11-19' AND t0.created_at < '2024-11-26' GROUP BY t1.country_name ORDER BY Average_Maximum_Salary DESC"
inquiry_dOjUoaAk,Which job categories have the highest and lowest fill rates?,"WITH hiredJobIds AS( SELECT job_id, FROM( SELECT JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') AS job_id, FROM `draftboard-368620.JEDIFY.analytic_events` AS ae WHERE event_name = 'Hired' AND created_at >= '2024-11-19' AND created_at < '2024-11-26' UNION ALL SELECT JSON_EXTRACT_SCALAR(DATA, '$.dms.jobId') AS job_id, FROM `draftboard-368620.JEDIFY.records` AS r WHERE event_name = 'Hired' UNION ALL SELECT JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') AS job_id, FROM `draftboard-368620.JEDIFY.analytic_events` AS ae WHERE event_name = 'Hired' UNION ALL SELECT JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') AS job_id, FROM `draftboard-368620.JEDIFY.records` AS r WHERE event_name = 'Hired' AND created_at >= '2024-11-19' AND created_at < '2024-11-26') WHERE job_id IS NOT NULL) SELECT j.function AS job_category, COUNT(*) AS total_jobs, COUNT(DISTINCT hiredJobIds.job_id) AS filled_jobs, SAFE_DIVIDE(COUNT(DISTINCT hiredJobIds.job_id), COUNT(*)) AS fill_rate FROM `draftboard-368620.JEDIFY.jobs` AS j LEFT JOIN hiredJobIds ON j.id=hiredJobIds.job_id GROUP BY j.function ORDER BY filled_jobs DESC"
inquiry_gdltGKQe,Show me scouts that have placed a candidate in the past but have not placed anybody in the last 60 days.,"WITH RecentActivity AS (SELECT ja.scout_id, MAX(CAST(ja.created_at AS TIMESTAMP)) as LastPlacementDate FROM `draftboard-368620.JEDIFY.job_applications` AS ja LEFT OUTER JOIN `draftboard-368620.JEDIFY.jobs` AS j ON ja.job_id = j.id WHERE ja.status = 100 GROUP BY ja.scout_id), PlacedScouts AS (SELECT scout_id FROM RecentActivity WHERE LastPlacementDate >= '2024-11-18' AND LastPlacementDate < '2024-11-25'), HistoricPlacements AS (SELECT scout_id, COUNT(*) as PlacementsBefore60Days FROM `draftboard-368620.JEDIFY.job_applications` AS ja WHERE status = 100 AND CAST(created_at AS TIMESTAMP) < '2024-11-18' GROUP BY scout_id) SELECT h.scout_id, u.name, h.PlacementsBefore60Days FROM HistoricPlacements h LEFT JOIN PlacedScouts p ON h.scout_id = p.scout_id LEFT JOIN `draftboard-368620.JEDIFY.users` u ON h.scout_id = u.id WHERE p.scout_id IS NULL;"
inquiry_jgBGakhc,What is the trend in offered salary?,"\n    SELECT \n        t.currency, \n        FORMAT_TIMESTAMP('%m/%d/%Y', CAST(t.created_at AS date)) AS date, \n        COALESCE(CAST(ROUND(AVG((t.min_amount + t.max_amount) / 2), 2) AS FLOAT64), 0) AS avg_offered_salary \n    FROM `draftboard-368620.JEDIFY.job_salaries` AS t \n    LEFT OUTER JOIN `draftboard-368620.JEDIFY.jobs` AS j ON t.job_id = j.id \n    LEFT OUTER JOIN `draftboard-368620.JEDIFY.company_industries` AS ci ON j.company_id = ci.company_id \n    WHERE t.currency = 'USD' \n    AND t.created_at >= '2024-08-01'\n    AND t.created_at < '2024-11-21'\n    GROUP BY t.currency, date, t.created_at \n    ORDER BY t.created_at desc\n    "
inquiry_qpHjaPCN,How has the average time to fill a job changed over time?,"\nDECLARE start_date DATE DEFAULT '2024-10-01';\nDECLARE end_date DATE DEFAULT '2024-10-31';\nDECLARE days_diff INT64 DEFAULT DATE_DIFF(end_date, start_date, DAY);\n\nWITH JobData AS (\n    SELECT \n        j.created_at,\n        DATE_DIFF(ja.last_activity_at, j.created_at, DAY) AS days_to_fill\n    FROM \n        `draftboard-368620.JEDIFY.jobs` j\n    JOIN `draftboard-368620.JEDIFY.job_applications` ja ON j.id = ja.job_id\n    WHERE \n        ja.highest_status IN (100, 35, 50)\n        AND j.created_at >= start_date \n        AND j.created_at < end_date\n),\nBucketedData AS (\n    SELECT\n        CASE \n            WHEN days_diff < 30 THEN FORMAT_TIMESTAMP('%m/%d/%Y', CAST(j.created_at AS TIMESTAMP))\n            WHEN days_diff <= 90 THEN FORMAT_TIMESTAMP('%m/%d/%Y', DATE_TRUNC(CAST(j.created_at AS TIMESTAMP), WEEK(MONDAY)))\n            ELSE FORMAT_TIMESTAMP('%m/%d/%Y', DATE_TRUNC(CAST(j.created_at AS TIMESTAMP), MONTH))\n        END AS bucket,\n        j.days_to_fill\n    FROM \n        JobData j\n)\n\nSELECT\n    bucket AS date,\n    AVG(days_to_fill) AS average_days_to_fill\nFROM \n    BucketedData\nGROUP BY \n    date\nORDER BY \n    date DESC;\n    "
inquiry_jElrPtuj,List the monthly active scouts that are not power scouts for each selected month,"\n    select month, count(distinct scout_id ) over (partition by month) as total_monthly_active_scouts,scout_id,scout_name,scout_email,total_scout_monthly_events,scout_approved_events,scout_declined_events,scout_Link_shared_events,involved_company_names,involved_job_names,involved_candidate_names from (select distinct e.month, e.scout_id,max(u.name) as scout_name,max(con.email) as scout_email, count(DISTINCT event_id) as total_scout_monthly_events, sum(approved) as scout_approved_events, sum(declined) as scout_declined_events, sum(Link_shared) as scout_Link_shared_events, STRING_AGG(distinct co.name, ', ') AS involved_company_names, STRING_AGG(distinct j.title, ', ') AS involved_job_names, STRING_AGG(distinct concat(ca.first_name,"" "",ca.last_name), ', ') AS involved_candidate_names,  from  (select distinct  JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id') AS scout_id ,JSON_EXTRACT_SCALAR(DATA, '$.dms.contact_id') AS contact_id,JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') as job_id, id AS event_id, created_at AS event_date, cast(DATE_TRUNC(created_at, MONTH) as date) as month, (case when event_name = ""Approved"" then 1 else 0 end) as approved, (case when event_name = ""Declined"" then 1 else 0 end) as declined, (case when event_name in (""LinkShared"",""WatchlistShared"") then 1 else 0 end) as Link_shared   FROM `draftboard-368620.JEDIFY.analytic_events`   where event_name in (""Approved"",""Declined"",""LinkShared"",""WatchlistShared"") and JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id') is not null and created_at >= '2024-06-01' AND created_at < '2024-11-20') e left join `JEDIFY.jobs` j on e.job_id = j.id left join `JEDIFY.companies` co on j.company_id = co.id left join `JEDIFY.candidates` ca on e.contact_id = ca.contact_id left join `JEDIFY.users` u on e.scout_id = u.id left join `JEDIFY.user_roles` ur on e.scout_id = ur.user_id left join `JEDIFY.contacts` con on u.contact_id = con.id where ur.role = 10 group by e.month,e.scout_id) q1   where total_scout_monthly_events <= 5 order by month desc, total_scout_monthly_events desc\n    "
inquiry_sEPZyMZX,List the monthly power scouts for each selected month,"\n    select month, count(distinct scout_id ) over (partition by month) as total_monthly_power_scouts,scout_id,scout_name,scout_email,total_scout_monthly_events,scout_approved_events,scout_declined_events,scout_Link_shared_events,involved_company_names,involved_job_names,involved_candidate_names from (select distinct e.month, e.scout_id,max(u.name) as scout_name,max(con.email) as scout_email, count(DISTINCT event_id) as total_scout_monthly_events, sum(approved) as scout_approved_events, sum(declined) as scout_declined_events, sum(Link_shared) as scout_Link_shared_events, STRING_AGG(distinct co.name, ', ') AS involved_company_names, STRING_AGG(distinct j.title, ', ') AS involved_job_names, STRING_AGG(distinct concat(ca.first_name,"" "",ca.last_name), ', ') AS involved_candidate_names,  from  (select distinct  JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id') AS scout_id ,JSON_EXTRACT_SCALAR(DATA, '$.dms.contact_id') AS contact_id,JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') as job_id, id AS event_id, created_at AS event_date, cast(DATE_TRUNC(created_at, MONTH) as date) as month, (case when event_name = ""Approved"" then 1 else 0 end) as approved, (case when event_name = ""Declined"" then 1 else 0 end) as declined, (case when event_name in (""LinkShared"",""WatchlistShared"") then 1 else 0 end) as Link_shared   FROM `draftboard-368620.JEDIFY.analytic_events`   where event_name in (""Approved"",""Declined"",""LinkShared"",""WatchlistShared"") and JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id') is not null and created_at >= '2024-10-01' AND created_at < '2024-11-20') e left join `JEDIFY.jobs` j on e.job_id = j.id left join `JEDIFY.companies` co on j.company_id = co.id left join `JEDIFY.candidates` ca on e.contact_id = ca.contact_id left join `JEDIFY.users` u on e.scout_id = u.id left join `JEDIFY.user_roles` ur on e.scout_id = ur.user_id left join `JEDIFY.contacts` con on u.contact_id = con.id where ur.role = 10 group by e.month,e.scout_id) q1   where total_scout_monthly_events > 5 order by month desc, total_scout_monthly_events desc\n    "
inquiry_urAkdSoB,How many scouts submitted applicants?,"\n    SELECT 'Total Scouts' as status, count(distinct id) as `Count` \n    FROM `draftboard-368620.JEDIFY.user_roles` \n    WHERE role=10 \n    AND created_at >= '2024-08-01' \n    AND created_at < '2024-09-01' \n    UNION ALL \n    SELECT 'Scouts With Applications' as status, count(distinct `scout_id`) as `Count` \n    FROM `draftboard-368620.JEDIFY.job_applications`\n    WHERE created_at >= '2024-08-01' \n    AND created_at < '2024-09-01'\n    "
inquiry_fBFvpESb,List the top 5 companies by number of jobs posted.,"\n    SELECT c.name, COUNT(DISTINCT j.id) AS job_count \n    FROM `draftboard-368620.JEDIFY.jobs` AS j \n    JOIN `draftboard-368620.JEDIFY.companies` AS c ON j.company_id=c.id \n    WHERE j.status='active' \n    AND j.created_at >= '2024-11-06' \n    AND j.created_at < '2024-11-13'\n    GROUP BY c.name \n    ORDER BY job_count DESC \n    LIMIT 5\n    "
inquiry_kRrYoobu,What is the typical bonus offered per job?,"\n    SELECT job_category, min_years_of_experience_bucket, COUNT(*) AS total_jobs, AVG(bonus_amount) AS avg_bonus \n    FROM(\n        SELECT \n            j.function AS job_category,\n            CASE \n                WHEN AVG(j.min_years_of_experience) < 2 THEN 'Less than 2 years of experience.'\n                WHEN AVG(j.min_years_of_experience) >= 2 AND AVG(j.min_years_of_experience) < 5 THEN 'Between 2 to 5 years of experience.'\n                WHEN AVG(j.min_years_of_experience) >= 5 AND AVG(j.min_years_of_experience) < 10 THEN 'Between 5 to 10 years of experience.'\n                ELSE 'More than 10 years of experience.'\n            END AS min_years_of_experience_bucket,\n            jd.bonus_amount AS bonus_amount\n        FROM `draftboard-368620.JEDIFY.jobs` AS j\n        LEFT JOIN `draftboard-368620.JEDIFY.job_details` AS jd ON jd.job_id = j.id\n        LEFT JOIN `draftboard-368620.JEDIFY.company_industries` AS ci ON j.company_id = ci.company_id\n        WHERE j.created_at >= '2024-08-01' AND j.created_at < '2024-09-01'\n        GROUP BY j.function, j.id, jd.bonus_amount\n    ) AS subquery\n    GROUP BY job_category, min_years_of_experience_bucket\n    ORDER BY avg_bonus DESC;\n    "
inquiry_nifhKEKZ,How does the average bonus amount vary by job function?,"\n    SELECT \n        j.function AS job_function, \n        COUNT(*) AS number_of_offers, \n        AVG(jd.bonus_amount) AS average_bonus_amount \n    FROM `draftboard-368620.JEDIFY.job_details` AS jd \n    JOIN `draftboard-368620.JEDIFY.jobs` j \n        ON jd.job_id = j.id \n    WHERE j.function IS NOT NULL \n        AND jd.created_at >= '2024-08-01'\n        AND jd.created_at < '2024-11-10'\n    GROUP BY j.function \n    ORDER BY average_bonus_amount DESC\n    "
inquiry_XVzXzKHh,"What are the power scout count, application events, and interview metrics for last month?","\n    select month, count(distinct scout_id ) over (partition by month) as total_monthly_active_scouts,scout_id,scout_name,scout_email,total_scout_monthly_events,scout_approved_events,scout_declined_events,scout_Link_shared_events,involved_company_names,involved_job_names,involved_candidate_names from (select distinct e.month, e.scout_id,max(u.name) as scout_name,max(con.email) as scout_email, count(DISTINCT event_id) as total_scout_monthly_events, sum(approved) as scout_approved_events, sum(declined) as scout_declined_events, sum(Link_shared) as scout_Link_shared_events, STRING_AGG(distinct co.name, ', ') AS involved_company_names, STRING_AGG(distinct j.title, ', ') AS involved_job_names, STRING_AGG(distinct concat(ca.first_name,"" "",ca.last_name), ', ') AS involved_candidate_names,  from  (select distinct  JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id') AS scout_id ,JSON_EXTRACT_SCALAR(DATA, '$.dms.contact_id') AS contact_id,JSON_EXTRACT_SCALAR(DATA, '$.dms.job_id') as job_id, id AS event_id, created_at AS event_date, cast(DATE_TRUNC(created_at, MONTH) as date) as month, (case when event_name = ""Approved"" then 1 else 0 end) as approved, (case when event_name = ""Declined"" then 1 else 0 end) as declined, (case when event_name in (""LinkShared"",""WatchlistShared"") then 1 else 0 end) as Link_shared   FROM `draftboard-368620.JEDIFY.analytic_events`   where event_name in (""Approved"",""Declined"",""LinkShared"",""WatchlistShared"") and JSON_EXTRACT_SCALAR(DATA, '$.dms.scout_id') is not null AND created_at >= '2024-09-01' AND created_at < '2024-11-08') e left join `JEDIFY.jobs` j on e.job_id = j.id left join `JEDIFY.companies` co on j.company_id = co.id left join `JEDIFY.candidates` ca on e.contact_id = ca.contact_id left join `JEDIFY.users` u on e.scout_id = u.id left join `JEDIFY.user_roles` ur on e.scout_id = ur.user_id left join `JEDIFY.contacts` con on u.contact_id = con.id where ur.role = 10 group by e.month,e.scout_id) q1   where total_scout_monthly_events <= 5 order by month desc, total_scout_monthly_events desc\n    "
inquiry_lJWAMwzl,What is the trend in the number of new scout signups per month?,"\n    SELECT FORMAT_TIMESTAMP('%m/%d/%Y', DATE_TRUNC(DATE(t.created_at), MONTH)) AS signup_month, \n    COUNT(DISTINCT t.id) AS new_scout_signups \n    FROM `draftboard-368620.JEDIFY.users` AS t \n    JOIN `draftboard-368620.JEDIFY.user_roles` AS ur ON t.id = ur.user_id \n    WHERE ur.role = 10 \n    AND t.created_at >= '2024-10-06' \n    AND t.created_at < '2024-10-26'\n    GROUP BY signup_month \n    ORDER BY signup_month\n    "
inquiry_RsPUyiGK,What is the average number of candidates per job?,"\n    SELECT AVG(candidate_count) AS average_candidates_per_job \n    FROM (\n        SELECT ja.job_id, COUNT(DISTINCT ja.contact_id) AS candidate_count \n        FROM `draftboard-368620.JEDIFY.job_applications` ja\n        JOIN `draftboard-368620.JEDIFY.jobs` j ON ja.job_id = j.id\n        JOIN `draftboard-368620.JEDIFY.candidate_locations` cl ON ja.contact_id = cl.candidate_id\n        JOIN `draftboard-368620.JEDIFY.company_industries` ci ON j.company_id = ci.company_id\n        JOIN `draftboard-368620.JEDIFY.company_ats` ca ON j.company_id = ca.company_id\n        WHERE j.created_at >= '2024-10-24' \n        AND j.created_at < '2024-10-31'\n        AND cl.country_name IN ('Algeria', 'Argentina', 'Armenia', 'Albania', 'Virgin Islands (US)', 'Vietnam')\n        AND j.function IN ('BD & Partnerships', 'Business Intelligence', 'Customer Success')\n        AND ci.title IN ('Analytics', 'BioTech', 'Climate', 'AI')\n        AND ca.partner <> 'draftboard'\n        GROUP BY ja.job_id\n    )\n    "
inquiry_YiqnKzWH,What is the average number of candidate rejections per job?,"\n    WITH Rejections AS (\n        SELECT j.title, COUNT(DISTINCT(COALESCE(ja.user_contact_id,ja.job_id))) AS rejections \n        FROM `draftboard-368620.JEDIFY.job_applications` ja \n        JOIN `draftboard-368620.JEDIFY.jobs` j ON ja.job_id = j.id \n        WHERE ja.status IN (13, 14, 17, 27)\n        AND ja.created_at >= '2024-10-01' \n        AND ja.created_at < '2024-10-31'\n        GROUP BY j.title\n    ), \n    Submissions AS (\n        SELECT j.title, COUNT(DISTINCT(COALESCE(ja.user_contact_id,ja.job_id))) AS submissions \n        FROM `draftboard-368620.JEDIFY.job_applications` ja \n        JOIN `draftboard-368620.JEDIFY.jobs` j ON ja.job_id = j.id \n        WHERE ja.created_at >= '2024-10-01' \n        AND ja.created_at < '2024-10-31'\n        GROUP BY j.title\n    ) \n    SELECT s.title, s.submissions, COALESCE(r.rejections, 0) AS rejections, \n    IFNULL(SAFE_DIVIDE(r.rejections,s.submissions), 0) AS average_rejection_rate \n    FROM Submissions s \n    LEFT JOIN Rejections r ON s.title = r.title \n    ORDER BY submissions DESC \n    LIMIT 30\n    "
inquiry_EkKbSpwe,How much time does it take to hold an ATS review?,"\nSELECT partner, AVG(diff) AS avg_days_to_review_by_ats \nFROM (\n  SELECT ca.partner, DATE_DIFF(ja.reviewed_at, ja.created_at, day) AS diff \n  FROM `draftboard-368620.JEDIFY.job_applications` ja \n  JOIN `draftboard-368620.JEDIFY.company_ats` ca ON ja.company_id = ca.company_id \n  WHERE ja.created_at IS NOT NULL \n    AND ja.reviewed_at IS NOT NULL \n    AND ca.partner IS NOT NULL\n    AND ja.created_at >= '2024-08-01' \n    AND ja.created_at < '2024-09-30'\n) \nGROUP BY partner \nORDER BY avg_days_to_review_by_ats\n"
inquiry_VYBTFSdD,What are the most popular positions posted?,"\nSELECT title, COUNT(*) AS job_count \nFROM `draftboard-368620.JEDIFY.jobs` AS j \nWHERE j.published_at IS NOT NULL\n  AND j.published_at >= '2024-09-01' \n  AND j.published_at < '2024-10-23'\nGROUP BY title \nORDER BY job_count DESC\n"
inquiry_eguadDeh,What is the average number of interviews held before rejection?,"\nWITH interviews AS (\n  SELECT application_id\n  FROM (\n    SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.application_id') AS application_id\n    FROM `draftboard-368620.JEDIFY.analytic_events`\n    WHERE created_at >= '2024-07-01' AND created_at < '2024-08-31'\n    UNION ALL\n    SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.application_id') AS application_id\n    FROM `draftboard-368620.JEDIFY.records`\n    WHERE created_at >= '2024-07-01' AND created_at < '2024-08-31'\n  )\n  WHERE event_name = 'Interaction'\n)\nSELECT AVG(num_interviews) AS avg_interviews_before_rejection\nFROM (\n  SELECT mja.id, COUNT(*) AS num_interviews\n  FROM interviews\n  LEFT JOIN `draftboard-368620.JEDIFY._job_applications` AS mja ON mja.id = interviews.application_id\n  WHERE mja.status = 27\n    AND mja.created_at >= '2024-07-01' AND mja.created_at < '2024-08-31'\n  GROUP BY mja.id\n)\n"
inquiry_bFuqHCxS,Show me the 10 scouts that submitted the most applicants but had the least placements.,"\nSELECT ja.scout_id, COUNT(DISTINCT ja.id) AS Total_Applicants, COUNT(DISTINCT CASE WHEN ja.highest_status IN(100, 50) THEN ja.id END) AS Successful_Placements \nFROM `draftboard-368620.JEDIFY.job_applications` AS ja \nLEFT OUTER JOIN `draftboard-368620.JEDIFY.jobs` j ON ja.job_id = j.id \nLEFT OUTER JOIN `draftboard-368620.JEDIFY.company_industries` ci ON j.company_id = ci.company_id \nWHERE ja.highest_status IS NOT NULL \n  AND ja.created_at >= '2024-06-01' \n  AND ja.created_at < '2024-09-30'\nGROUP BY ja.scout_id \nORDER BY Total_Applicants DESC, Successful_Placements ASC \nLIMIT 10\n"
inquiry_VkveWvyt,How many candidates have been placed in jobs so far?,"\nSELECT count(distinct id) AS `Placed_Candidates`\nFROM `draftboard-368620.JEDIFY.job_applications`\nWHERE `highest_status` in (100,35,50)\n  AND created_at >= '2024-10-03'\n  AND created_at < '2024-10-10'\n"
inquiry_HsamYndu,What is the typical test period required for a job?,"\nSELECT job_category, min_years_of_experience_bucket, COUNT(*) AS total_jobs, AVG(probation_period) AS avg_probation_period_in_days \nFROM (\n  SELECT j.function AS job_category, \n    CASE \n      WHEN AVG(j.min_years_of_experience) < 2 THEN 'Less than 2 years of experience.'\n      WHEN AVG(j.min_years_of_experience) >= 2 AND AVG(j.min_years_of_experience) < 5 THEN 'Between 2 to 5 years of experience.'\n      WHEN AVG(j.min_years_of_experience) >= 5 AND AVG(j.min_years_of_experience) < 10 THEN 'Between 5 to 10 years of experience.'\n      ELSE 'More than 10 years of experience.'\n    END AS min_years_of_experience_bucket,\n    jd.probation_period AS probation_period\n  FROM `draftboard-368620.JEDIFY.jobs` AS j\n  LEFT JOIN `draftboard-368620.JEDIFY.job_details` AS jd ON jd.job_id = j.id\n  WHERE j.created_at >= '2024-10-01' AND j.created_at < '2024-10-08'\n  GROUP BY j.function, j.id, jd.probation_period\n) AS subquery\nGROUP BY job_category, min_years_of_experience_bucket\nORDER BY avg_probation_period_in_days DESC;\n"
inquiry_FcCaKXHt,How often is a job posted?,"\nWITH JobPostDates AS (\n    SELECT\n        DATE(published_at) AS job_post_date,\n        LEAD(DATE(published_at)) OVER (ORDER BY DATE(published_at)) AS next_job_post_date\n    FROM `draftboard-368620.JEDIFY.jobs`\n    WHERE published_at >= '2024-09-30' AND published_at < '2024-10-07'\n),\nDateDiffs AS (\n    SELECT\n        job_post_date,\n        DATE_DIFF(next_job_post_date, job_post_date, DAY) AS days_between_posts\n    FROM JobPostDates\n    WHERE next_job_post_date IS NOT NULL\n)\nSELECT\n    COUNT(*) AS total_jobs,\n    AVG(days_between_posts) AS avg_days_between_posts\nFROM DateDiffs;\n"
inquiry_XfPHKWiI,How many of the applications sent to ATS are rejected?,"\nSELECT COUNT(*) AS `Total sent to ATS`, COUNT(CASE WHEN ja.status=17 THEN 1 ELSE NULL END) AS `Rejected by ATS`\nFROM `draftboard-368620.JEDIFY.job_applications` ja\nJOIN `draftboard-368620.JEDIFY.company_ats` ca ON ja.company_id=ca.company_id\nWHERE ca.partner <> 'draftboard'\n  AND ja.created_at >= '2024-07-01'\n  AND ja.created_at < '2024-10-01'\n"
inquiry_kXanqZtW,How many of the total applications are sent for an ATS review?,"\nDECLARE start_date DATE DEFAULT '2024-09-01';\nDECLARE end_date DATE DEFAULT '2024-10-04';\nDECLARE days_diff INT64 DEFAULT DATE_DIFF(end_date, start_date, DAY);\n\nWITH BucketedData AS (\n    SELECT\n        ja.company_id,\n        ca.partner,\n        CASE\n            WHEN days_diff < 30 THEN FORMAT_DATE('%m/%d/%Y', DATE(ja.created_at))\n            WHEN days_diff <= 90 THEN FORMAT_DATE('%m/%d/%Y', DATE_TRUNC(DATE(ja.created_at), WEEK))\n            ELSE FORMAT_DATE('%m/%d/%Y', DATE_TRUNC(DATE(ja.created_at), MONTH))\n        END AS bucket\n    FROM \n        `draftboard-368620.JEDIFY.job_applications` ja\n    JOIN \n        `draftboard-368620.JEDIFY.company_ats` ca ON ja.company_id = ca.company_id\n    WHERE \n        ja.created_at >= '2024-09-01' AND ja.created_at < '2024-10-04'\n)\n\nSELECT\n    bucket AS date,\n    COUNT(*) AS `Total applications`,\n    COUNT(CASE WHEN partner <> 'draftboard' THEN 1 ELSE NULL END) AS `Sent to ATS`\nFROM\n    BucketedData\nGROUP BY\n    bucket\nORDER BY\n    bucket DESC;\n"
inquiry_CETFVzSs,How many new jobs have been created?,
inquiry_pjWkDyeL,Produce a summary of job referrals per scout forw whole 2024,"\nSELECT u.name, COUNT(DISTINCT ja.id) AS jobs_referred, SUM( CASE WHEN ja.status IN (100,35,50) THEN 1 ELSE 0 END) AS successful_referrals, SUM(CASE WHEN ja.status IN (13,14,17) THEN 1 ELSE 0 END ) AS rejected_referrals\nFROM `draftboard-368620.JEDIFY.users` AS u\nJOIN `draftboard-368620.JEDIFY.job_applications` AS ja ON u.id = ja.scout_id\nWHERE u.name IS NOT NULL \n  AND u.name <> '' \n  AND ja.created_at >= '2024-09-04' \n  AND ja.created_at < '2024-09-11'\nGROUP BY u.name, u.rating\nORDER BY successful_referrals DESC, rejected_referrals DESC, jobs_referred DESC\nLIMIT 30\n"
inquiry_FRveFqvJ,What is the total number of jobs posted to date?,\nSELECT COUNT(DISTINCT `id`) AS total_jobs \nFROM `draftboard-368620.JEDIFY.jobs` AS t \nWHERE published_at IS NOT NULL\n  AND published_at >= '2024-08-06' \n  AND published_at < '2024-08-13'\n
inquiry_pmrCweLv,Which companies signed up?,\nSELECT DISTINCT company_name\nFROM `moz-fx-data-shared-prod.revenue_derived.stripe_customers_v1`\nWHERE created_at >= '2024-07-30' AND created_at < '2024-08-06'\n
inquiry_ZQDaIhAe,What is the drop-off from joining as a company to posting a job to placing a candidate?,"\nWITH hiredCompanyIds AS(\n  SELECT company_id\n  FROM(\n    SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.comapnyId') AS company_id,\n    FROM `draftboard-368620.JEDIFY.analytic_events`\n    WHERE event_name = 'Hired'\n    AND created_at >= '2024-07-26' AND created_at < '2024-08-02'\n    UNION ALL\n    SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.comapnyId') AS company_id,\n    FROM `draftboard-368620.JEDIFY.records`\n    WHERE event_name = 'Hired'\n    AND created_at >= '2024-07-26' AND created_at < '2024-08-02'\n    UNION ALL\n    SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.company_id') AS company_id,\n    FROM `draftboard-368620.JEDIFY.analytic_events`\n    WHERE event_name = 'Hired'\n    AND created_at >= '2024-07-26' AND created_at < '2024-08-02'\n    UNION ALL\n    SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.company_id') AS company_id,\n    FROM `draftboard-368620.JEDIFY.records`\n    WHERE event_name = 'Hired'\n    AND created_at >= '2024-07-26' AND created_at < '2024-08-02'\n  )\n  WHERE company_id IS NOT NULL\n)\nSELECT\n  COUNT(DISTINCT c.id) AS companies,\n  COUNT(CASE WHEN j.jobs_count>=1 THEN 1 ELSE NULL END) AS companies_with_at_least_one_job,\n  COUNT(DISTINCT hiredCompanyIds.company_id) AS companies_with_at_least_one_hire\nFROM `draftboard-368620.JEDIFY.companies` AS c\nLEFT JOIN (\n  SELECT company_id, COUNT(DISTINCT id) AS jobs_count\n  FROM `draftboard-368620.JEDIFY.jobs`\n  WHERE created_at >= '2024-07-26' AND created_at < '2024-08-02'\n  GROUP BY company_id\n) AS j ON j.company_id=c.id\nLEFT JOIN hiredCompanyIds ON hiredCompanyIds.company_id=c.id\nWHERE c.created_at >= '2024-07-26' AND c.created_at < '2024-08-02'\n"
inquiry_pqMZPRtD,What is the trend in activation time for scouts over a specified period?,"\nDECLARE start_date DATE DEFAULT '2024-07-22';\nDECLARE end_date DATE DEFAULT '2024-07-29';\nDECLARE days_diff INT64 DEFAULT DATE_DIFF(end_date, start_date, DAY);\nWITH UserData AS (\n    SELECT \n        u.created_at, \n        u.id,\n        DATE_DIFF(MIN(ja.created_at), MIN(u.created_at), DAY) AS days_to_activate\n    FROM \n        `JEDIFY.users` u\n    JOIN `JEDIFY.user_roles` ur ON u.id = ur.user_id\n    JOIN `JEDIFY.job_applications` ja ON u.id = ja.scout_id\n    GROUP BY \n        u.id, u.created_at\n    HAVING\n    COUNT(DISTINCT ur.role)=1 AND MAX(ur.role)=10\n),\nBucketedData AS (\n    SELECT\n        CASE \n            WHEN days_diff < 30 THEN FORMAT_DATE('%m/%d/%Y', DATE(u.created_at))\n            WHEN days_diff <= 90 THEN FORMAT_DATE('%m/%d/%Y', DATE_TRUNC(DATE(u.created_at), WEEK(MONDAY)))\n            ELSE FORMAT_DATE('%m/%d/%Y', DATE_TRUNC(DATE(u.created_at), MONTH))\n        END AS bucket,\n        u.id,\n        u.days_to_activate\n    FROM \n        UserData u\n    WHERE \n        u.created_at >= '2024-07-22' AND u.created_at < '2024-07-29'\n)\nSELECT\n    bucket AS bucket_size,\n    COUNT(DISTINCT id) AS created_scouts,\n    AVG(days_to_activate) AS avg_days_to_activate\nFROM \n    BucketedData\nGROUP BY \n    bucket_size\nORDER BY \n    bucket_size DESC;\n"
inquiry_jFkDobwd,How does the ARR distribution compare between Enterprise and SMB accounts?,
inquiry_IpoCymGi,"Which companies are served by the ""Greenhouse"" partner?",SELECT c.name FROM `JEDIFY.company_ats` ca JOIN `JEDIFY.companies` c ON ca.company_id = c.id WHERE (ca.partner = 'greenhouse' OR ca.partner = 'greenhouseboard')   AND ca.created_at >= '2024-06-30'   AND ca.created_at < '2024-07-07'
inquiry_lpiFnHis,Show the candidates with the highest interview-to-offer ratio.,"WITH interviews AS(   SELECT contact_id, application_id   FROM(     SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.application_id') AS application_id, JSON_EXTRACT_SCALAR(DATA, '$.dms.contact_id') AS contact_id     FROM `draftboard-368620.JEDIFY.analytic_events` AS ae     WHERE created_at >= '2024-05-01' AND created_at < '2024-06-24'     UNION ALL     SELECT event_name, JSON_EXTRACT_SCALAR(DATA, '$.dms.application_id') AS application_id, JSON_EXTRACT_SCALAR(DATA, '$.dms.contact_id') AS contact_id     FROM `draftboard-368620.JEDIFY.records` AS r     WHERE created_at >= '2024-05-01' AND created_at < '2024-06-24'   )   WHERE event_name = 'Interaction' ) SELECT concat(c.first_name,' ',c.last_name) as candidate_name,        COUNT(*) AS num_interviews,        COUNT(DISTINCT o.id) AS offers,        (COUNT(DISTINCT o.id)/COUNT(*)) AS ratio FROM interviews LEFT JOIN `draftboard-368620.JEDIFY.candidates` AS c ON interviews.contact_id=c.contact_id LEFT JOIN `draftboard-368620.JEDIFY.offers` AS o ON o.application_id=interviews.application_id GROUP BY concat(c.first_name,' ',c.last_name) ORDER BY ratio DESC LIMIT 30"
inquiry_svLcGRVb,How long does it typically take for a user who join our service to convert?,"SELECT    FORMAT_TIMESTAMP('%m/%d/%Y',DATE_TRUNC(is_first_time_date, DAY)) AS Join_date,   SUM(Pro_Upgraded_Occured) AS total_upgrades,   COUNT(DISTINCT uoc.track_email) new_users,   FORMAT(""%.2f"",AVG(Days_to_Pro_Upgrade_From_Is_First_Time)) AS Days_to_Pro_Upgrade FROM `elementor.user_only_characteristic` as uoc JOIN `jedify-400815.elementor.event_metadata_new` AS emn   ON uoc.track_id_created=emn.track_record_id WHERE    is_first_time_date >= CAST('2024-01-01' AS DATETIME)   AND is_first_time_date < CAST('2024-01-08' AS DATETIME)   AND uoc.country IN ('United States', 'United Kingdom')   AND emn.version IN ('3.18.2', '3.18.3', '3.17.1')   AND emn.product IN ('Pro') GROUP BY Join_date ORDER BY Join_date"
inquiry_JWharYXw,Are the salary ranges offered rising over time?,"SELECT `t`.`currency`, CAST(created_at AS date) AS date, COALESCE(CAST(ROUND(AVG((t.min_amount + t.max_amount) / 2), 2) AS FLOAT64), 0) AS avg_offered_salary  FROM `draftboard-368620`.`JEDIFY`.`job_salaries` AS `t` WHERE `t`.`currency` = 'USD'    AND created_at >= '2024-05-31'    AND created_at < '2024-06-07' GROUP BY `t`.`currency`, date ORDER BY date desc;"
inquiry_hCMdcVrh,What is the monthly trend in companies signups?,"SELECT `name` as company_name, cast(min(`created_at`) as timestamp) signed_up_date FROM `draftboard-368620.JEDIFY.companies` AS mj WHERE `created_at` >= '2024-03-01' AND `created_at` < '2024-05-31' GROUP BY `name` ORDER BY signed_up_date DESC"
inquiry_ojpwqZsN,Which ATS partners are most commonly used by companies on the platform?,"SELECT partner, count(distinct company_id) as cnt FROM `draftboard-368620.JEDIFY.company_ats` WHERE created_at >= '2024-03-01' AND created_at < '2024-05-31' GROUP BY partner"
inquiry_gwVvGNoC,Can you list scouts with 3-8 applications?,"WITH applicationsCount AS(   SELECT scout_id, COUNT(*) AS application_count   FROM `draftboard-368620.JEDIFY.matchmaker_job_application`   WHERE created_at >= '2024-03-01' AND created_at < '2024-05-31'   GROUP BY scout_id ) SELECT 'Less than 3 applications' AS Bucket, COUNT(CASE WHEN application_count<3 THEN 1 ELSE NULL END ) AS application_count FROM applicationsCount UNION ALL SELECT 'Between 3 and 8 applications' AS Bucket, COUNT(CASE WHEN application_count>=3 AND application_count<=8 THEN 1 ELSE NULL END ) AS application_count FROM applicationsCount UNION ALL SELECT 'More than 8 applications' AS Bucket, COUNT(CASE WHEN application_count>8 THEN 1 ELSE NULL END ) AS application_count FROM applicationsCount"
inquiry_pavmdAjg,Get the list of jobs that have been open for more than 60 days.,"SELECT id, title, published_at FROM `draftboard-368620.JEDIFY.jobs` AS j WHERE j.status = 'active'   AND CAST(j.published_at AS TIMESTAMP) >= TIMESTAMP('2024-03-01')   AND CAST(j.published_at AS TIMESTAMP) < TIMESTAMP('2024-05-31')   AND (j.archived_at IS NULL OR CAST(j.archived_at AS TIMESTAMP) > CURRENT_TIMESTAMP()) ORDER BY j.published_at ASC"
inquiry_dXUxZMKU,Which jobs have been posted to date?,"SELECT j.id AS job_id, c.name AS company_name, j.title as job_title, j.published_at, j.description  FROM `draftboard-368620.JEDIFY.jobs` AS j JOIN `draftboard-368620.JEDIFY.companies` AS c ON c.id = j.company_id WHERE j.published_at >= '2024-02-01' AND j.published_at < '2024-05-10' AND j.status = 'active' ORDER BY j.published_at DESC"
inquiry_wMMvZVYt,What is the average number of candidates rejected/approved per scout?,"SELECT u.name, COUNT(DISTINCT ja.id) AS jobs_referred, SUM( CASE WHEN ja.status = 100 THEN 1 ELSE 0 END) AS successful_referrals, SUM(CASE WHEN ja.status = 35 THEN 1 ELSE 0 END ) AS probation_referrals FROM `draftboard-368620.JEDIFY.users` AS u JOIN `draftboard-368620.JEDIFY.job_applications` AS ja ON u.id = ja.scout_id WHERE u.name IS NOT NULL   AND u.name <> ''   AND ja.created_at >= '2024-01-01'   AND ja.created_at < '2024-01-27' GROUP BY u.name, u.rating ORDER BY successful_referrals DESC, probation_referrals DESC, jobs_referred DESC"
inquiry_iIqSbznQ,How Often Is A Job Posted?,"WITH JobPostDates AS(   SELECT      DATE(published_at) AS job_post_date,     LEAD(DATE(published_at)) OVER (ORDER BY DATE(published_at)) AS next_job_post_date   FROM `draftboard-368620.JEDIFY.jobs`   WHERE DATE(published_at) BETWEEN '2024-01-01' AND '2024-04-29' ), DateDiffs AS (   SELECT      job_post_date,     DATE_DIFF(next_job_post_date, job_post_date, DAY) AS days_between_posts   FROM JobPostDates   WHERE next_job_post_date IS NOT NULL ) SELECT   COUNTIF(days <= 7) AS jobs_last_week,   AVG(CASE WHEN days <= 7 THEN days_between_posts ELSE NULL END) AS avg_days_between_posts_last_week,   COUNTIF(days <= 30) AS jobs_last_month,   AVG(CASE WHEN days <= 30 THEN days_between_posts ELSE NULL END) AS avg_days_between_posts_last_month,   COUNTIF(days <= 90) AS jobs_last_3_months,   AVG(CASE WHEN days <= 90 THEN days_between_posts ELSE NULL END) AS avg_days_between_posts_last_3_months,   COUNTIF(days <= 180) AS jobs_last_6_months,   AVG(CASE WHEN days <= 180 THEN days_between_posts ELSE NULL END) AS avg_days_between_posts_last_6_months,   COUNTIF(days <= 365) AS jobs_last_year,   AVG(CASE WHEN days <= 365 THEN days_between_posts ELSE NULL END) AS avg_days_between_posts_last_year FROM DateDiffs, UNNEST([DATE_DIFF(CURRENT_DATE(), job_post_date, DAY)]) AS days;"
inquiry_zZXzZGVE,How Many Candidates Have Been Placed In Jobs So Far?,"SELECT count(distinct id) AS `Placed_Candidates` FROM `draftboard-368620.JEDIFY.job_applications` WHERE `highest_status` in (100,35,50)   AND `created_at` BETWEEN '2024-01-01' AND '2024-04-29'"
inquiry_QhdkyxjB,Get The List Of Jobs That Have Been Open For More Than 60 Days.,"SELECT id, title, published_at FROM `draftboard-368620.JEDIFY.jobs` AS j WHERE j.status = 'active'   AND CAST(j.published_at AS TIMESTAMP) <= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 60 DAY)   AND CAST(j.published_at AS TIMESTAMP) >= CAST('2024-01-01' AS TIMESTAMP)   AND CAST(j.published_at AS TIMESTAMP) <= CAST('2024-01-07' AS TIMESTAMP)   AND (j.archived_at IS NULL OR CAST(j.archived_at AS TIMESTAMP) > CURRENT_TIMESTAMP()) ORDER BY j.published_at ASC"
